<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="net.lab1024.sa.admin.module.business.stockio.dao.StockIoDao">

    <!-- 分页查询 -->
    <select id="queryPage" resultType="net.lab1024.sa.admin.module.business.stockio.domain.vo.StockIoVO">
        SELECT a.id,a.org_id,a.stock_no,a.goods_id,s.goods_code,s.goods_name,b.code depot_code,b.name depot_name,
        d.code supplie_code,d.name supplie_name,a.oper_num,a.ctime,a.cemp_name,a.description,case a.type when 0
            then '入库' else '出库' end type
        FROM t_stock_io a, t_depot b,t_goods s,t_supplie d
        <where>
            and a.depot_id=b.id and a.goods_id=s.goods_id and a.supplie_id=d.id
            <!--供应商-->
            <if test="queryForm.supplieId != null and queryForm.supplieId != ''">
                        AND INSTR(a.supplie_id,#{queryForm.supplie})
            </if>
            <!--商品编码/名称-->
            <if test="queryForm.goodsId != null and queryForm.goodsId != ''">
                AND (s.goods_id = #{queryForm.goodsId}
                OR s.goods_name LIKE concat('%', #{queryForm.goodsId}, '%'))
            </if>
            <!--仓库编码/名称-->
            <if test="queryForm.depotId != null and queryForm.depotId != ''">
                AND (b.id = #{queryForm.depotId}
                OR b.name LIKE concat('%', #{queryForm.depotId}, '%'))
            </if>
            <!--类型-->
            <if test="queryForm.type != null">
                AND a.type = #{queryForm.type}
            </if>
            <!--创建时间-->
            <if test="queryForm.ctimeBegin != null">
                AND DATE_FORMAT(a.ctime, '%Y-%m-%d') &gt;= #{queryForm.ctimeBegin}
            </if>
            <if test="queryForm.ctimeEnd != null">
                AND DATE_FORMAT(a.ctime, '%Y-%m-%d') &lt;= #{queryForm.ctimeEnd}
            </if>
        </where>
    </select>


</mapper>